<!doctype html>
<html lang="zh_CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>H5 BOT SDK DEMO</title>
    <script>
        // window.WebViewJavascriptBridge = {
        //     init: function () {

        //     },
        //     callHandler: function (funName, data, cb) {
        //         console.log('callHandler: ', funName, data);
        //         if (funName === 'uploadLinkClicked') {
        //             setTimeout(() => {
        //                 this.uploadLinkClicked(data);
        //             }, 1000);
        //         }
        //     },
        //     registerHandler: function (funName, cb) {
        //         console.log('registerHandler: ', funName);
        //         if (funName === 'onHandleIntent') {
        //             this.handleIntentCb = cb;
        //         }
        //     },

        //     uploadLinkClicked(data) {
        //         data = JSON.parse(data);
        //         if (data.url.indexOf('getAdResources') > -1) {
        //             this.handleIntentCb(JSON.stringify({
        //                 "intent": {
        //                     "name": "RenderAdvertisement"
        //                 },
        //                 "customData": JSON.stringify({
        //                     "jsonData": "{\"status\":0,\"materials\":[{\"type\":\"IMAGE_LEFT\",\"assets\":{\"image\":{\"url\":\"https:\\\/\\\/lupic.cdn.bcebos.com\\\/20191130\\\/8021544%2320.jpg\"},\"title\":\"别家宴会厅这么有档次，原来是用的全息投影\",\"content\":\"\"},\"monitors\":{\"exposure\":[\"dueros:\\\/\\\/f34646bc-37b4-a9db-361f-48fe7ca8831d\\\/eventHandle?token=eyJpZCI6IjFFdG5XYkhqSnN0T3EwaHNHODM4V2lNYmdpUFdYbThNOTFRbTdlYjNkeDgrcE84enlCaXdMSFdHOE9pNkZiU1NNMGdocmtoN0JTekh5MVJWYXE5QUpPRUxxd0NkNTc4RDlPZmsyR1R0emxPalV6dE1QSjZlalBiYlllQkdzcVdnVUdld3d6emFreTVGS1d3MzQ0dERHREhwSnBaQUc1Z1g0ZkpnK1wvUnFvVWZ1dlhkemlIMFhMWkJKNGR3QkN3WWx1UFlPZ3dxOFdIazNUa2hpXC9ZMGpoV3FlNWg4YnIyeDNidGhFbWkwb0Q5QTU0SjdPTVJDYVBxYmQxWks5VmdtZG5TdWxpYlhhZDFpS3pMUSs3aDJVZDZOWlpDQ3pNUER2ZUVJOXVUWTlZOFFseTJxZWRYNjh4TkVuN0NybHJNOWFpc3lYdXhVUmN3Ylp3ZisweFkzZjFHS09XOXhQcnVcL3Q2RERHb0dyRzVtTktVaGl4bnQzV3VGbkowTzlBV0YzVHJ6NVwvaWZzVUNKNWFPdlgwbVNaRlQ2eFdtcFp1bDZTSHZiV0FEMGloR1ZvPSIsImFkU2xvdCI6IjEyMDAwMCIsInRlbXBsYXRlSWQiOiJJTUFHRSIsImV2ZW50IjoiRVhQT1NVUkUiLCJhZF90ZW1wbGF0ZSI6IklNQUdFIiwiYWRfbWF0ZXJpYWxfaWQiOiJtc3NwLTI3MDQ4NTEyMzIifQ%3D%3D\"],\"click\":[\"dueros:\\\/\\\/f34646bc-37b4-a9db-361f-48fe7ca8831d\\\/eventHandle?token=eyJpZCI6IjFFdG5XYkhqSnN0T3EwaHNHODM4V2lNYmdpUFdYbThNOTFRbTdlYjNkeDgrcE84enlCaXdMSFdHOE9pNkZiU1NNMGdocmtoN0JTekh5MVJWYXE5QUpPRUxxd0NkNTc4RDlPZmsyR1R0emxPalV6dE1QSjZlalBiYlllQkdzcVdnVUdld3d6emFreTVGS1d3MzQ0dERHREhwSnBaQUc1Z1g0ZkpnK1wvUnFvVWZ1dlhkemlIMFhMWkJKNGR3QkN3WWx1UFlPZ3dxOFdIazNUa2hpXC9ZMGpoV3FlNWg4YnIyeDNidGhFbWkwb0Q5QTU0SjdPTVJDYVBxYmQxWks5VmdtZG5TdWxpYlhhZDFpS3pMUSs3aDJVZDZOWlpDQ3pNUER2ZUVJOXVUWTlZOFFseTJxZWRYNjh4TkVuN0NybHJNOWFpc3lYdXhVUmN3Ylp3ZisweFkzZjFHS09XOXhQcnVcL3Q2RERHb0dyRzVtTktVaGl4bnQzV3VGbkowTzlBV0YzVHJ6NVwvaWZzVUNKNWFPdlgwbVNaRlQ2eFdtcFp1bDZTSHZiV0FEMGloR1ZvPSIsImFkU2xvdCI6IjEyMDAwMCIsInRlbXBsYXRlSWQiOiJJTUFHRSIsImV2ZW50IjoiQ0xJQ0siLCJhZF90ZW1wbGF0ZSI6IklNQUdFIiwiYWRfbWF0ZXJpYWxfaWQiOiJtc3NwLTI3MDQ4NTEyMzIifQ%3D%3D&clickUrl=http%3A%2F%2Fcpro.baidu.com%2Fcpro%2Fui%2Fuijs.php%3Fen%3DmywWUA71T1Yknzu9TZKxpyfqn1T3P16vn101rau9TZKxTv-b5yRkm1m1nvu-FhPC5H0huAbqPHcYnW63Fh-VuybqrjmsP1R3njf1rHbzPWbYFh-Vuy-xmL0qnauGTdq9TZ0qniuJp1YYrHF-PWF9uhDkPjcsn17hFh_qFRnLFRFDFRPjFRRdFRFaFRDdFRcvFR7AFRPDFRcvFRf1FRcsFRnYFRnYFRFjFRfzFRFKFRn1FhkdpvbqniuVmLKV5HRzn10hULnqmy4bThqGuauk5yRkm1m1nvu-gvPsTBuzmWYkFMF15HDhTvwogLmqPau1uAVxIhNzTv-EUWYdQWm8nau1uyk_ugFxpyfqnBu1pyfqnymsn1fzmH79uWmznhRYriu1IA-b5HmsnjDhIjdYTAP_pyPouyf1gvdEm-q9TLKxnzuYUgnqnHR3n1f3nH6drauYIHYvrHnzPWDkFMRqpZwYTaR1fiRzwBRzwWwBuAcYmiRzwaRzwARkm1m1nvu-FHF7mvqVFMNGUy-b5HcYP1b1PW6vrjbhIWYzFhbqmyRdnhfLPjD%26adx%3D1%26besl%3D0%26br%3D0%26c%3Dnews%26cf%3D1%26cp%3Dfc_middle_page_app%26cvrq%3D371295%26ds%3Dfmp%26fr%3D1%26fv%3D0%26h%3D600%26haacp%3D107%26iif%3D1%26img_typ%3D22630%26itm%3D0%26lu_idc%3Dtc%26lukid%3D1%26lus%3D1f0342a1af622e49%26lust%3D5e620402%26mscf%3D0%26mtids%3D8021544%26n%3D10%26nttp%3D3%26oi%3D25%26p%3Dbaidu%26sce%3D5%26sh%3D600%26sr%3D0%26ssp2%3D0%26sw%3D1024%26swi%3D1%26tpl%3Dtemplate_inlay_all_mobile_lu_native_ad_app_feed_rect%26tsf%3Ddtp%3A2%26tt_sign%3D%25B1%25F0%25BC%25D2%25D1%25E7%25BB%25E1%25CC%25FC%25D5%25E2%25C3%25B4%25D3%25D0%25B5%25B5%25B4%25CE%25A3%25AC%25D4%25AD%25C0%25B4%25CA%25C7%25D3%25C3%25B5%25C4%25C8%25AB%25CF%25A2%25CD%25B6%25D3%25B0%26tt_src%3D16384%26u%3D%26uicf%3Dlurecv%26urlid%3D0%26w%3D1024%26wi%3D4%26eot%3D1\"],\"close\":[\"dueros:\\\/\\\/f34646bc-37b4-a9db-361f-48fe7ca8831d\\\/eventHandle?token=eyJpZCI6IjFFdG5XYkhqSnN0T3EwaHNHODM4V2lNYmdpUFdYbThNOTFRbTdlYjNkeDgrcE84enlCaXdMSFdHOE9pNkZiU1NNMGdocmtoN0JTekh5MVJWYXE5QUpPRUxxd0NkNTc4RDlPZmsyR1R0emxPalV6dE1QSjZlalBiYlllQkdzcVdnVUdld3d6emFreTVGS1d3MzQ0dERHREhwSnBaQUc1Z1g0ZkpnK1wvUnFvVWZ1dlhkemlIMFhMWkJKNGR3QkN3WWx1UFlPZ3dxOFdIazNUa2hpXC9ZMGpoV3FlNWg4YnIyeDNidGhFbWkwb0Q5QTU0SjdPTVJDYVBxYmQxWks5VmdtZG5TdWxpYlhhZDFpS3pMUSs3aDJVZDZOWlpDQ3pNUER2ZUVJOXVUWTlZOFFseTJxZWRYNjh4TkVuN0NybHJNOWFpc3lYdXhVUmN3Ylp3ZisweFkzZjFHS09XOXhQcnVcL3Q2RERHb0dyRzVtTktVaGl4bnQzV3VGbkowTzlBV0YzVHJ6NVwvaWZzVUNKNWFPdlgwbVNaRlQ2eFdtcFp1bDZTSHZiV0FEMGloR1ZvPSIsImFkU2xvdCI6IjEyMDAwMCIsInRlbXBsYXRlSWQiOiJJTUFHRSIsImV2ZW50IjoiQ0xPU0UiLCJhZF90ZW1wbGF0ZSI6IklNQUdFIiwiYWRfbWF0ZXJpYWxfaWQiOiJtc3NwLTI3MDQ4NTEyMzIifQ%3D%3D\"]},\"props\":{\"autoSwitch\":true,\"duration\":10000}}],\"props\":{\"autoSwitch\":true,\"duration\":10000,\"htmlAddress\":\"https%3A%2F%2Fxiaodu.baidu.com%2Fsaiya%2Fsdk%2Fiframe%2Fad-wrapper.html\"}}"
        //                 })
        //             }),  function () {});
        //         }
        //     }
        // }
    </script>
    <script src="https://cdn.bootcss.com/vConsole/3.3.4/vconsole.min.js"></script>
     <script src="http://duer.bdstatic.com/saiya/sdk/h5-bot-sdk.1.7.2.js"></script>
    <style>
        body {
            background: aqua;
        }
        button {
            min-width: 120px;
            height: 40px;
        }
        #log{
            word-wrap: break-word;
            word-break: break-all;
        }
    </style>
</head>
<body>
<button id="applicate-account">账号绑定</button>
<button id="applicate-pay">使用requireCharge购买</button>
<!--<button id="applicate-buy">使用Buy购买</button>-->
<button id="applicate-listen">激活聆听</button>
<button id="applicate-speak">播报"我要早点下班"</button>
<button id="applicate-register">获取register结果</button>
<button id="applicate-uicontext">updateUIContext</button>
<button id="request-close">退出页面</button>
<button id="clear-log">清除页面日志</button>
<button id="applicate-link">LinkClicked</button>
<button id="applicate-ship">requireShipping</button>
<button id="applicate-age">实名认证</button>
<button id="adv-incentive">激励广告展示</button>
<h1 id="gg-type"></h1>
<button id="adv-upload-vertical">切换到竖屏广告</button>
<button id="adv-upload-horiz">切换到横屏广告</button>
<!-- <button id="link-realname">展示实名认证二维码</button> -->
<div id="log"></div>
<script>
    var vConsole = new VConsole();// 初始化
    var $btnAccount = document.getElementById('applicate-account');
    var $btnPay = document.getElementById('applicate-pay');
    var $btnListen = document.getElementById('applicate-listen');
    var $btnSpeak = document.getElementById('applicate-speak');
    var $btnGetRegisterResult = document.getElementById('applicate-register');
    var $btnUpdateUIContext = document.getElementById('applicate-uicontext');
    var $btnClearLog = document.getElementById('clear-log');
    var $btnClose = document.getElementById('request-close');
    var $btnLink = document.getElementById('applicate-link');
    var $btnShip = document.getElementById('applicate-ship');
    // var $btnBuy = document.getElementById('applicate-buy');
    var $btnAge = document.getElementById('applicate-age');
    // var $btnRealName = document.getElementById('link-realname');
    var $btnAdvIncentive = document.getElementById('adv-incentive');
    var $ggType = document.getElementById('gg-type');
    var $log = document.getElementById('log');

    var isHeng = location.href.indexOf('hengping') > -1;

    function log(data) {
        let type = 'string ';
        if (typeof data === 'object') {
            type = 'object ';
            try {
                data = JSON.stringify(data);
            } catch (e) {
                data = JSON.stringify(e);
            }
        }
        var now = new Date();
        var hour = now.getHours();
        var minu = now.getMinutes();
        var sec = now.getSeconds();
        var dateStr = '<br>[' + hour + ':' + minu + ':' + sec + ']';
        $log.innerHTML += dateStr + type + data;
    }

    window.addEventListener('load', function () {
        window.botApp = new BotApp({
            // random1: '3a939b0cee832fb0e634e1f6f28ee44e',
            // signature1: 'e6f8041f11824ec2fed7b11e27f6588a',
            // random2: '4a983fd442144eaec73c3ca35ae78aa0',
            // signature2: '1ea04b2c23877a9a221aace7384dc2d0',
            // skillID: '699e74f5-b879-1926-1e11-51998f05ea68',

            random1: 'dengxuening1',
            signature1: 'bfad270a00aa9e13bb52b71a50e7b886',
            random2: 'dengxuening2',
            signature2: '0c733ac217fb778ff66049a4c24f48ec',
            skillID: '3fa55179-6903-4094-57cf-8ae21d9a6123',
        });

        if (isHeng) {
            $ggType.innerText = '测试横屏广告';
        } else {
            $ggType.innerText = '测试竖屏广告';
        }

        botApp.initAd({
            // zIndex: 10010,
            // screenOrientation: isHeng ? 'landscape' : 'portrait', // 'portrait' => 竖屏， landscape => 全屏
            // displayStrategy: 'twice', // once => 用户关闭后不再填充广告， twice => 用户关闭后再填充一次
            // clickCallback: function (err, data) {
            //     log('用户点击了广告');
            // },
            // displayCallback: function() {
            //     log('广告展示成功');
            // },
            // closeCallback: function() {
            //     log('用户关闭了广告');
            // },
            // switchCallback: function() {
            //     log('广告切换成功');
            // },
            // firstDisplayTime: 1,
            // bannerPosition: {
            //     right: '230px',
            //     bottom: '130px'
            // },
            // placeId: '222',
            screenOrientation:"portrait",
            zIndex: 9999,
            displayStrategy: 'once',
            firstDisplayTime: 1,
            bannerPosition: {
                right: '30px',
                bottom: '30px'
            },
            placeId: '5bnTSA3%2Bk%2FlCppVdt9bzxe%2B7gnZMFYgnMQLXt3dB%2FWFKf4lyam1he4m8ubUrZ0dj2d5T49v1ld1b9JHT%2B6ZhWIp9T6niQuPFPWCZ%2BpOIZhg%3D',
            clickCallback: function () {
                log('用户点击了广告');
            },
            closeCallback: function () {
                log('用户关闭了广告');
            },
            displayCallback: function () {
                log('广告展示成功');
            },
            switchCallback: function() {
                log('广告切换成功');
            }
        });

        botApp.onLinkAccountSuccess(function (data) {
            log('收到 onLinkAccountSuccess 调用');
            console.log(data);
            log(data);
        });

        botApp.onChargeStatusChange(function (data) {
            log('收到 onChargeStatusChange 调用');
            log(data);
        });

        botApp.onHandleIntent(function (data) {
            log('收到 onHandleIntent 调用');
            console.log(data);
            log(data);
        });
        botApp.onClickLink(function (data) {
            log('收到 onClickLink 调用');
            console.log(data);
            log(data);
        });

        botApp.onHandleScreenNavigatorEvent(function (data) {
            log('收到 onHandleScreenNavigatorEvent 调用');
            console.log(data);
            log(data);
        });

        $btnAccount.onclick = function () {
            log('发起账号授权');
            botApp.requireLinkAccount(function (data) {
                log('收到授权结果');
                log(data);
            });
        };

        $btnPay.onclick = function () {
            var data = {
                token: 'fjaksvmakfjiefj23fdsnfs',
                chargeBaiduPay: {
                    authorizeAttributes: {
                        authorizationAmount: {
                            amount: '0.01',
                            currencyCode: 'CNY'
                        },
                        sellerAuthorizationNote: '双11大促'
                    },
                    sellerOrderAttributes: {
                        sellerOrderId: 'hfuawffu2jkjk12e23',
                        productName: 'Mac Book Pro 2019',
                        productId: '191025095313376709',
                        description: '笔记本电脑',
                        sellerNote: '大促销'
                    }
                }
            };
            log('发起收款，参数如下');
            log(data);
            botApp.requireCharge(data, function (err, data) {
                console.error(err);
                console.log(data);
                log(data);
            });
        }

        $btnListen.onclick = function () {
            log('开始激活聆听');
            botApp.listen();
        }

        $btnSpeak.onclick = function () {
            log('开始播报TTS');
            botApp.speak('我要早点下班', function () {
                log('TTS播报完毕');
            });
        }

        $btnUpdateUIContext.onclick = function () {
            log('开始定义UIContext，参数如下');
            var data = {
                enableGeneralUtterances: true,
                hyperUtterances: [
                    {
                        url: 'https://www.apple.com',
                        utterances: ['苹果'],
                        type: 'link',
                        params: {}
                    },
                    {
                        url: 'https://www.banana.com',
                        utterances: ['香蕉'],
                        type: 'link',
                        params: {}
                    },
                    {
                        url: 'https://www.strawberry.com',
                        utterances: ['草莓'],
                        type: 'link',
                        params: {}
                    },
                ]
            };
            log(data);
            botApp.updateUiContext(data, function () {
                log('发送updateUiContext完毕');
            });
        }

        $btnGetRegisterResult.onclick = function () {
            log('开始获取注册结果');
            botApp.getRegisterResult(function (data) {
                log('收到register结果');
                log(data);
            });
        }

        $btnClearLog.onclick = function () {
            $log.innerHTML = '';
        }

        $btnClose.onclick = function () {
            log('请求退出');
            botApp.requestClose();
        }

        $btnLink.onclick = function () {
            log('上报LinkClicked，参数如下');
            var data = {
                url: 'dueros://d7a12baa-47d5-437f-7af6-05bc9c4e5c28/?openbot=true&oss_channel=ls_m'
            };
            log(data);
            botApp.uploadLinkClicked(data);
        }

        $btnShip.onclick = function () {
            log('上报requireShipping');
            botApp.requireShipping();
        }

        // $btnBuy.onclick = function () {
        //     log('requireBuy，参数如下');
        //     var data = {
        //         productId: '191022141334493984',
        //         sellerOrderId: '23r230203fsfd1l3nr32390'
        //     };
        //     log(data);
        //     botApp.requireBuy(data, function (err, data) {
        //         log('收到requireBuy回调');
        //         log(data);
        //     });
        // }

        $btnAge.onclick = function () {
            log('请求实名认证结果');
            botApp.requireUserAgeInfo(function (err, data) {
                log('收到requireUserAgeInfo结果');
                if (err) {
                    log(err);
                } else {
                    log(data);
                }
            });
        }

        // $btnRealName.onclick = function () {
        //     log('上报实名认证事件，参数如下');
        //     var data = {
        //         url: 'dueros://94e1a677-d1b3-4dd5-0f0c-b6dd0eeb1c6b/certification?action=realName'
        //     };
        //     log(data);
        //     botApp.uploadLinkClicked(data);
        // }

        $btnAdvIncentive.onclick = function () {
            log('尝试展示激励广告');
            // botApp.showIncentiveAdv();
        }

        document.getElementById('adv-upload-vertical').onclick = function () {
            location.href = 'http://cdn.dengxuening.com/ad-demo.html?v=2.3';
        }

        document.getElementById('adv-upload-horiz').onclick = function () {
            location.href = 'http://cdn.dengxuening.com/ad-demo.html?v=2.3&type=hengping';
        }
    });

</script>
</body>
</html>
